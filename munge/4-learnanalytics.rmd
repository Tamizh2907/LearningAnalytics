---
title: "Learn Analytics"
author: "Thamizhiniyan Pugazhenthi"
date: "16/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document to analyse the data set of Learning Analytics.

### CSV files to dataframes ###

Read all csv files and convert those to data frames

```{r}

#read all csv file to data frame

data_files = list.files("data/", pattern = "^c")  # Identify file names

#data_files # Print file names

for(i in 1:length(data_files)) { #for loop to convert csv to data frames
  
  readcsvfile = read.csv(paste0("data/", data_files[i]))
  
  substringdata = substr(data_files[i], 1, nchar(data_files[i])-4)
  
  substringdata = gsub("-", "", substringdata)
  
  substringdata = gsub("_", "", substringdata)
  
  assign(substringdata, readcsvfile)
  
}

```
### Connect dataframes ###

Create connection between data frames to identify the primary key and foreign key

```{r}

#Enrollment connection

enrolment = rbind(cybersecurity1enrolments, cybersecurity2enrolments, cybersecurity3enrolments, cybersecurity4enrolments,
                  
                  cybersecurity5enrolments, cybersecurity6enrolments, cybersecurity7enrolments)

#archetype connection

archetype = rbind(cybersecurity1archetypesurveyresponses, cybersecurity2archetypesurveyresponses, cybersecurity3archetypesurveyresponses,
                  
                  cybersecurity4archetypesurveyresponses, cybersecurity5archetypesurveyresponses, cybersecurity6archetypesurveyresponses,
                  
                  cybersecurity7archetypesurveyresponses)

#leaving survey responses

leavingsurvey = rbind(cybersecurity1leavingsurveyresponses, cybersecurity2leavingsurveyresponses, cybersecurity3leavingsurveyresponses,
                      
                      cybersecurity4leavingsurveyresponses, cybersecurity5leavingsurveyresponses, cybersecurity6leavingsurveyresponses,
                      
                      cybersecurity7leavingsurveyresponses)

#question response

questionresponse = rbind(cybersecurity1questionresponse, cybersecurity2questionresponse, cybersecurity3questionresponse,
                         
                         cybersecurity4questionresponse, cybersecurity5questionresponse, cybersecurity6questionresponse,
                         
                         cybersecurity7questionresponse)

#step activity

stepactivity = rbind(cybersecurity1stepactivity, cybersecurity2stepactivity, cybersecurity3stepactivity,
                     
                     cybersecurity4stepactivity, cybersecurity5stepactivity, cybersecurity6stepactivity,
                     
                     cybersecurity7stepactivity)

#weekly sentiment survey

weeklysurvey = rbind(cybersecurity1weeklysentimentsurveyresponses, cybersecurity2weeklysentimentsurveyresponses,
                     
                     cybersecurity3weeklysentimentsurveyresponses, cybersecurity4weeklysentimentsurveyresponses,
                     
                     cybersecurity5weeklysentimentsurveyresponses, cybersecurity6weeklysentimentsurveyresponses,
                     
                     cybersecurity7weeklysentimentsurveyresponses)

#team members

teammembers = rbind(cybersecurity2teammembers, cybersecurity3teammembers, cybersecurity4teammembers, cybersecurity5teammembers,
                    
                    cybersecurity6teammembers, cybersecurity7teammembers)

#video stats

videostats = rbind(cybersecurity3videostats, cybersecurity4videostats, cybersecurity5videostats, cybersecurity6videostats,
                   
                   cybersecurity7videostats)

#sort based on a column

enrolment = enrolment[order(enrolment$learner_id),]

archetype = archetype[order(archetype$learner_id),]

leavingsurvey = leavingsurvey[order(leavingsurvey$learner_id),]

questionresponse = questionresponse[order(questionresponse$learner_id),]

stepactivity = stepactivity[order(stepactivity$learner_id),]

weeklysurvey = weeklysurvey[order(weeklysurvey$id),]

teammembers = teammembers[order(teammembers$id),]

videostats = videostats[order(videostats$step_position),]

#drop NA

questionresponse = questionresponse[!(questionresponse$learner_id == ""),]

#merge data frames

merge1 = unique(merge(enrolment, stepactivity, by.x = "learner_id", by.y = "learner_id", all.x = TRUE))

merge2 = unique(merge(enrolment, teammembers, by.x = "learner_id", by.y = "id"))

merge3 = unique(merge(merge1, questionresponse, by.x = c("learner_id", "week_number", "step_number"),
                      
                by.y = c("learner_id", "week_number", "step_number"), all.x = TRUE))

merge4 = unique(merge(merge3, archetype, by.x = "learner_id", by.y = "learner_id", all.x = TRUE))

merge5 = unique(merge(merge4, weeklysurvey, by.x = "id", by.y = "id", all.x = TRUE))

finalmerge = unique(merge(merge5, leavingsurvey, by.x = "learner_id", by.y = "learner_id", all.x = TRUE))


#compare enrollment of each run

enrolrun1 = c(run = 1, count = length(unique(cybersecurity1enrolments$learner_id)))

enrolrun2 = c(run = 2, count = length(unique(cybersecurity2enrolments$learner_id)))

enrolrun3 = c(run = 3, count = length(unique(cybersecurity3enrolments$learner_id)))

enrolrun4 = c(run = 4, count = length(unique(cybersecurity4enrolments$learner_id)))

enrolrun5 = c(run = 5, count = length(unique(cybersecurity5enrolments$learner_id)))

enrolrun6 = c(run = 6, count = length(unique(cybersecurity6enrolments$learner_id)))

enrolrun7 = c(run = 7, count = length(unique(cybersecurity7enrolments$learner_id)))

enrolcompile = data.frame(rbind(enrolrun1, enrolrun2, enrolrun3, enrolrun4, enrolrun5, enrolrun6, enrolrun7))


#compare step activity of each run

steprun11 = c(week = 1, run = 1, count = length(unique(cybersecurity1stepactivity$learner_id[cybersecurity1stepactivity$week_number == 1])))

steprun12 = c(week = 1, run = 2, count = length(unique(cybersecurity2stepactivity$learner_id[cybersecurity2stepactivity$week_number == 1])))

steprun13 = c(week = 1, run = 3, count = length(unique(cybersecurity3stepactivity$learner_id[cybersecurity3stepactivity$week_number == 1])))

steprun14 = c(week = 1, run = 4, count = length(unique(cybersecurity4stepactivity$learner_id[cybersecurity4stepactivity$week_number == 1])))

steprun15 = c(week = 1, run = 5, count = length(unique(cybersecurity5stepactivity$learner_id[cybersecurity5stepactivity$week_number == 1])))

steprun16 = c(week = 1, run = 6, count = length(unique(cybersecurity6stepactivity$learner_id[cybersecurity6stepactivity$week_number == 1])))

steprun17 = c(week = 1, run = 7, count = length(unique(cybersecurity1stepactivity$learner_id[cybersecurity7stepactivity$week_number == 1])))

steprun21 = c(week = 2, run = 1, count = length(unique(cybersecurity1stepactivity$learner_id[cybersecurity1stepactivity$week_number == 2])))

steprun22 = c(week = 2, run = 2, count = length(unique(cybersecurity2stepactivity$learner_id[cybersecurity2stepactivity$week_number == 2])))

steprun23 = c(week = 2, run = 3, count = length(unique(cybersecurity3stepactivity$learner_id[cybersecurity3stepactivity$week_number == 2])))

steprun24 = c(week = 2, run = 4, count = length(unique(cybersecurity4stepactivity$learner_id[cybersecurity4stepactivity$week_number == 2])))

steprun25 = c(week = 2, run = 5, count = length(unique(cybersecurity5stepactivity$learner_id[cybersecurity5stepactivity$week_number == 2])))

steprun26 = c(week = 2, run = 6, count = length(unique(cybersecurity6stepactivity$learner_id[cybersecurity6stepactivity$week_number == 2])))

steprun27 = c(week = 2, run = 7, count = length(unique(cybersecurity1stepactivity$learner_id[cybersecurity7stepactivity$week_number == 2])))

steprun31 = c(week = 3, run = 1, count = length(unique(cybersecurity1stepactivity$learner_id[cybersecurity1stepactivity$week_number == 3])))

steprun32 = c(week = 3, run = 2, count = length(unique(cybersecurity2stepactivity$learner_id[cybersecurity2stepactivity$week_number == 3])))

steprun33 = c(week = 3, run = 3, count = length(unique(cybersecurity3stepactivity$learner_id[cybersecurity3stepactivity$week_number == 3])))

steprun34 = c(week = 3, run = 4, count = length(unique(cybersecurity4stepactivity$learner_id[cybersecurity4stepactivity$week_number == 3])))

steprun35 = c(week = 3, run = 5, count = length(unique(cybersecurity5stepactivity$learner_id[cybersecurity5stepactivity$week_number == 3])))

steprun36 = c(week = 3, run = 6, count = length(unique(cybersecurity6stepactivity$learner_id[cybersecurity6stepactivity$week_number == 3])))

steprun37 = c(week = 3, run = 7, count = length(unique(cybersecurity1stepactivity$learner_id[cybersecurity7stepactivity$week_number == 3])))


stepruncompile = data.frame(rbind(steprun11, steprun12, steprun13, steprun14, steprun15, steprun16, steprun17,
                                  
                                  steprun21, steprun22, steprun23, steprun24, steprun25, steprun26, steprun27,
                                  
                                  steprun31, steprun32, steprun33, steprun34, steprun35, steprun36, steprun37))



#compare by quiz responses

quizruntrue11 = c(week = 1, run = 1, count = length(unique(cybersecurity1questionresponse$learner_id[cybersecurity1questionresponse$week_number == 1 & cybersecurity1questionresponse$correct == "true"])))

quizruntrue12 = c(week = 1, run = 2, count = length(unique(cybersecurity2questionresponse$learner_id[cybersecurity2questionresponse$week_number == 1 & cybersecurity2questionresponse$correct == "true"])))

quizruntrue13 = c(week = 1, run = 3, count = length(unique(cybersecurity3questionresponse$learner_id[cybersecurity3questionresponse$week_number == 1 & cybersecurity3questionresponse$correct == "true"])))

quizruntrue14 = c(week = 1, run = 4, count = length(unique(cybersecurity4questionresponse$learner_id[cybersecurity4questionresponse$week_number == 1 & cybersecurity4questionresponse$correct == "true"])))

quizruntrue15 = c(week = 1, run = 5, count = length(unique(cybersecurity5questionresponse$learner_id[cybersecurity5questionresponse$week_number == 1 & cybersecurity5questionresponse$correct == "true"])))

quizruntrue16 = c(week = 1, run = 6, count = length(unique(cybersecurity6questionresponse$learner_id[cybersecurity6questionresponse$week_number == 1 & cybersecurity6questionresponse$correct == "true"])))

quizruntrue17 = c(week = 1, run = 7, count = length(unique(cybersecurity7questionresponse$learner_id[cybersecurity7questionresponse$week_number == 1 & cybersecurity7questionresponse$correct == "true"])))

quizruntrue21 = c(week = 2, run = 1, count = length(unique(cybersecurity1questionresponse$learner_id[cybersecurity1questionresponse$week_number == 2 & cybersecurity1questionresponse$correct == "true"])))

quizruntrue22 = c(week = 2, run = 2, count = length(unique(cybersecurity2questionresponse$learner_id[cybersecurity2questionresponse$week_number == 2 & cybersecurity2questionresponse$correct == "true"])))

quizruntrue23 = c(week = 2, run = 3, count = length(unique(cybersecurity3questionresponse$learner_id[cybersecurity3questionresponse$week_number == 2 & cybersecurity3questionresponse$correct == "true"])))

quizruntrue24 = c(week = 2, run = 4, count = length(unique(cybersecurity4questionresponse$learner_id[cybersecurity4questionresponse$week_number == 2 & cybersecurity4questionresponse$correct == "true"])))

quizruntrue25 = c(week = 2, run = 5, count = length(unique(cybersecurity5questionresponse$learner_id[cybersecurity5questionresponse$week_number == 2 & cybersecurity5questionresponse$correct == "true"])))

quizruntrue26 = c(week = 2, run = 6, count = length(unique(cybersecurity6questionresponse$learner_id[cybersecurity6questionresponse$week_number == 2 & cybersecurity6questionresponse$correct == "true"])))

quizruntrue27 = c(week = 2, run = 7, count = length(unique(cybersecurity7questionresponse$learner_id[cybersecurity7questionresponse$week_number == 2 & cybersecurity7questionresponse$correct == "true"])))

quizruntrue31 = c(week = 3, run = 1, count = length(unique(cybersecurity1questionresponse$learner_id[cybersecurity1questionresponse$week_number == 3 & cybersecurity1questionresponse$correct == "true"])))

quizruntrue32 = c(week = 3, run = 2, count = length(unique(cybersecurity2questionresponse$learner_id[cybersecurity2questionresponse$week_number == 3 & cybersecurity2questionresponse$correct == "true"])))

quizruntrue33 = c(week = 3, run = 3, count = length(unique(cybersecurity3questionresponse$learner_id[cybersecurity3questionresponse$week_number == 3 & cybersecurity3questionresponse$correct == "true"])))

quizruntrue34 = c(week = 3, run = 4, count = length(unique(cybersecurity4questionresponse$learner_id[cybersecurity4questionresponse$week_number == 3 & cybersecurity4questionresponse$correct == "true"])))

quizruntrue35 = c(week = 3, run = 5, count = length(unique(cybersecurity5questionresponse$learner_id[cybersecurity5questionresponse$week_number == 3 & cybersecurity5questionresponse$correct == "true"])))

quizruntrue36 = c(week = 3, run = 6, count = length(unique(cybersecurity6questionresponse$learner_id[cybersecurity6questionresponse$week_number == 3 & cybersecurity6questionresponse$correct == "true"])))

quizruntrue37 = c(week = 3, run = 7, count = length(unique(cybersecurity7questionresponse$learner_id[cybersecurity7questionresponse$week_number == 3 & cybersecurity7questionresponse$correct == "true"])))

quizrunfalse11 = c(week = 1, run = 1, count = length(unique(cybersecurity1questionresponse$learner_id[cybersecurity1questionresponse$week_number == 1 & cybersecurity1questionresponse$correct == "false"])))

quizrunfalse12 = c(week = 1, run = 2, count = length(unique(cybersecurity2questionresponse$learner_id[cybersecurity2questionresponse$week_number == 1 & cybersecurity2questionresponse$correct == "false"])))

quizrunfalse13 = c(week = 1, run = 3, count = length(unique(cybersecurity3questionresponse$learner_id[cybersecurity3questionresponse$week_number == 1 & cybersecurity3questionresponse$correct == "false"])))

quizrunfalse14 = c(week = 1, run = 4, count = length(unique(cybersecurity4questionresponse$learner_id[cybersecurity4questionresponse$week_number == 1 & cybersecurity4questionresponse$correct == "false"])))

quizrunfalse15 = c(week = 1, run = 5, count = length(unique(cybersecurity5questionresponse$learner_id[cybersecurity5questionresponse$week_number == 1 & cybersecurity5questionresponse$correct == "false"])))

quizrunfalse16 = c(week = 1, run = 6, count = length(unique(cybersecurity6questionresponse$learner_id[cybersecurity6questionresponse$week_number == 1 & cybersecurity6questionresponse$correct == "false"])))

quizrunfalse17 = c(week = 1, run = 7, count = length(unique(cybersecurity7questionresponse$learner_id[cybersecurity7questionresponse$week_number == 1 & cybersecurity7questionresponse$correct == "false"])))

quizrunfalse21 = c(week = 2, run = 1, count = length(unique(cybersecurity1questionresponse$learner_id[cybersecurity1questionresponse$week_number == 2 & cybersecurity1questionresponse$correct == "false"])))

quizrunfalse22 = c(week = 2, run = 2, count = length(unique(cybersecurity2questionresponse$learner_id[cybersecurity2questionresponse$week_number == 2 & cybersecurity2questionresponse$correct == "false"])))

quizrunfalse23 = c(week = 2, run = 3, count = length(unique(cybersecurity3questionresponse$learner_id[cybersecurity3questionresponse$week_number == 2 & cybersecurity3questionresponse$correct == "false"])))

quizrunfalse24 = c(week = 2, run = 4, count = length(unique(cybersecurity4questionresponse$learner_id[cybersecurity4questionresponse$week_number == 2 & cybersecurity4questionresponse$correct == "false"])))

quizrunfalse25 = c(week = 2, run = 5, count = length(unique(cybersecurity5questionresponse$learner_id[cybersecurity5questionresponse$week_number == 2 & cybersecurity5questionresponse$correct == "false"])))

quizrunfalse26 = c(week = 2, run = 6, count = length(unique(cybersecurity6questionresponse$learner_id[cybersecurity6questionresponse$week_number == 2 & cybersecurity6questionresponse$correct == "false"])))

quizrunfalse27 = c(week = 2, run = 7, count = length(unique(cybersecurity7questionresponse$learner_id[cybersecurity7questionresponse$week_number == 2 & cybersecurity7questionresponse$correct == "false"])))

quizrunfalse31 = c(week = 3, run = 1, count = length(unique(cybersecurity1questionresponse$learner_id[cybersecurity1questionresponse$week_number == 3 & cybersecurity1questionresponse$correct == "false"])))

quizrunfalse32 = c(week = 3, run = 2, count = length(unique(cybersecurity2questionresponse$learner_id[cybersecurity2questionresponse$week_number == 3 & cybersecurity2questionresponse$correct == "false"])))

quizrunfalse33 = c(week = 3, run = 3, count = length(unique(cybersecurity3questionresponse$learner_id[cybersecurity3questionresponse$week_number == 3 & cybersecurity3questionresponse$correct == "false"])))

quizrunfalse34 = c(week = 3, run = 4, count = length(unique(cybersecurity4questionresponse$learner_id[cybersecurity4questionresponse$week_number == 3 & cybersecurity4questionresponse$correct == "false"])))

quizrunfalse35 = c(week = 3, run = 5, count = length(unique(cybersecurity5questionresponse$learner_id[cybersecurity5questionresponse$week_number == 3 & cybersecurity5questionresponse$correct == "false"])))

quizrunfalse36 = c(week = 3, run = 6, count = length(unique(cybersecurity6questionresponse$learner_id[cybersecurity6questionresponse$week_number == 3 & cybersecurity6questionresponse$correct == "false"])))

quizrunfalse37 = c(week = 3, run = 7, count = length(unique(cybersecurity7questionresponse$learner_id[cybersecurity7questionresponse$week_number == 3 & cybersecurity7questionresponse$correct == "false"])))

quizruntruecompile = data.frame(rbind(quizruntrue11, quizruntrue12, quizruntrue13, quizruntrue14, quizruntrue15, quizruntrue16, quizruntrue17,
                                      
                                      quizruntrue21, quizruntrue22, quizruntrue23, quizruntrue24, quizruntrue25, quizruntrue26, quizruntrue27,
                                      
                                      quizruntrue31, quizruntrue32, quizruntrue33, quizruntrue34, quizruntrue35, quizruntrue36, quizruntrue37))

quizrunfalsecompile = data.frame(rbind(quizrunfalse11, quizrunfalse12, quizrunfalse13, quizrunfalse14, quizrunfalse15, quizrunfalse16, quizrunfalse17,
                                       
                                       quizrunfalse21, quizrunfalse22, quizrunfalse23, quizrunfalse24, quizrunfalse25, quizrunfalse26, quizrunfalse27,
                                       
                                       quizrunfalse31, quizrunfalse32, quizrunfalse33, quizrunfalse34, quizrunfalse35, quizrunfalse36, quizrunfalse37))


#Compare weekly responses

weeklyresponse11 = c(week = 1, rating = 1, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 1 & weeklysurvey$experience_rating == 1])))

weeklyresponse12 = c(week = 1, rating = 2, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 1 & weeklysurvey$experience_rating == 2])))

weeklyresponse13 = c(week = 1, rating = 3, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 1 & weeklysurvey$experience_rating == 3])))

weeklyresponse21 = c(week = 2, rating = 1, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 2 & weeklysurvey$experience_rating == 1])))

weeklyresponse22 = c(week = 2, rating = 2, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 2 & weeklysurvey$experience_rating == 2])))

weeklyresponse23 = c(week = 2, rating = 3, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 2 & weeklysurvey$experience_rating == 3])))

weeklyresponse31 = c(week = 3, rating = 1, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 3 & weeklysurvey$experience_rating == 1])))

weeklyresponse32 = c(week = 3, rating = 2, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 3 & weeklysurvey$experience_rating == 2])))

weeklyresponse33 = c(week = 3, rating = 3, count = length(unique(weeklysurvey$id[weeklysurvey$week_number == 3 & weeklysurvey$experience_rating == 3])))

weeklycompile = data.frame(rbind(weeklyresponse11, weeklyresponse12, weeklyresponse13, weeklyresponse21, weeklyresponse22,
                                 
                                 weeklyresponse23, weeklyresponse31, weeklyresponse32, weeklyresponse33))

vectorinvideostats = c()

for (loop in 1:13){
  
  sequenceadd = seq(3,7,1)
  
  vectorinvideostats = append(vectorinvideostats, sequenceadd)
  
}

videostats$run_number = vectorinvideostats

videostatsaggregate = aggregate(videostats[, 3:28], list(videostats$step_position), mean)

colnames(videostatsaggregate)[1] = "step_position"

videostatsaggregaterun = aggregate(videostats[, 3:28], list(videostats$run_number), mean)

colnames(videostatsaggregaterun)[1] = "run_number"

```

## Plots to analyse the data from enrolment to leaving survey


```{r}

#various analysis of data

library(tidyverse)

library(ggplot2)

library(ggplot2movies)

# Basic bar plot

#Analysis by age

ggplot(enrolment, aes(age_range)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Count of enrolment by age") + theme_minimal()

#Analysis by gender

ggplot(enrolment, aes(gender)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Count of enrolment by gender") + theme_minimal()

#Analysis by highest education

ggplot(enrolment, aes(highest_education_level)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Count of enrolment by highest education level") + theme_minimal()

#Analysis by employment status

ggplot(enrolment, aes(employment_status)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Count of enrolment by employment status") + theme_minimal()

#Analysis by week number

ggplot(stepactivity, aes(week_number)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners by week number") + theme_minimal()

#Analysis by step number

stepactivity %>%
  
  filter(week_number == "1") %>%
  
  ggplot(aes(step_number)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners by step number - 1") + theme_minimal()


stepactivity %>%
  
  filter(week_number == "2") %>%
  
  ggplot(aes(step_number)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners by step number - 2") + theme_minimal()


stepactivity %>%
  
  filter(week_number == "3") %>%
  
  ggplot(aes(step_number)) + geom_bar(stat="count") + 
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners by step number - 3") + theme_minimal()


#Analysis by question response

questionresponse %>%
  
  filter(quiz_question != "") %>% unique(.) %>%

  ggplot(aes(correct)) + geom_bar(stat="count") +
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners by responses") + theme_minimal()

questionresponse %>%
  
  filter(quiz_question != "") %>% unique(.) %>%
  
  ggplot(aes(fill = correct, x = quiz_question)) + geom_bar(position = "stack", stat="count") +
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners for each question by responses") + theme_minimal()



#Analysis by weekly response

boxplot(week_number~experience_rating, data=weeklysurvey, main="Experience rating by week", 
          
        xlab="Week number", ylab="Experience rating")


#Analysis by archetypes

archetype %>%
  
  unique(.) %>%
  
  ggplot(aes(archetype)) + geom_bar(stat="count") +
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners by archetypes") + theme_minimal()


finalmerge %>%
  
  filter(quiz_question != "NA") %>% filter(archetype != "NA") %>% unique(.) %>%
  
  ggplot(aes(fill = correct, x = archetype)) + geom_bar(position = "stack", stat="count") +
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + ggtitle("Learners for each question by responses") + theme_minimal()


#Analysis by video stats

videostats %>%
  
  unique(.) %>% group_by(step_position) %>%
  
  ggplot(aes(step_position, total_views)) + geom_bar(stat="identity") +
  
  ggtitle("Video watched by step position") + theme_minimal()


#Analysis by leaving survey

leavingsurvey %>%
  
  filter(last_completed_step != "NA") %>%
  
  ggplot(aes(last_completed_step)) + geom_bar(stat="count") +
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + 
  
  ggtitle("Leaving response by step number") + theme_minimal()


#Analysis by team members

teammembers %>%
  
  ggplot(aes(fill = user_role, team_role)) + geom_bar(position = "stack", stat="count") +
  
  geom_text(stat='count', aes(label=..count..), vjust=-1) + 
  
  ggtitle("Team members by enrolment role") + theme_minimal()



#Analysis by each run

enrolcompile %>%
  
  ggplot(aes(x = run, y = count)) + geom_line() + geom_point() +
  
  geom_label(aes(label = count)) + ggtitle("Number of enrolments in each run") + theme_minimal()
  
  

stepruncompile %>%
  
  ggplot(aes(x = run, y = count, group = week, color = as.factor(week))) + geom_line() + geom_point() +
  
  scale_color_manual(values=c('#FF0000','#0000FF', '#097969')) + geom_label(aes(label = count)) + labs(color = "week") +
  
  ggtitle("Number of visitors by week in each run") + theme_minimal()
  

quizruntruecompile %>%
  
  ggplot(aes(x = run, y = count, group = week, color = as.factor(week))) + geom_line() + geom_point() +
  
  scale_color_manual(values=c('#FF0000','#0000FF', '#097969')) + geom_label(aes(label = count)) + labs(color = "week") +
  
  ggtitle("Number of correct responses to quiz by week in each run") + theme_minimal()

quizrunfalsecompile %>%
  
  ggplot(aes(x = run, y = count, group = week, color = as.factor(week))) + geom_line() + geom_point() +
  
  scale_color_manual(values=c('#FF0000','#0000FF', '#097969')) + geom_label(aes(label = count)) + labs(color = "week") +
  
  ggtitle("Number of wrong responses to quiz by week in each run") + theme_minimal()


weeklycompile %>%
  
  ggplot(aes(x = rating, y = count, group = week, color = as.factor(week))) + geom_line() + geom_point() +
  
  scale_color_manual(values=c('#FF0000','#0000FF', '#097969')) + geom_label(aes(label = count)) + labs(color = "week") +
  
  ggtitle("Number of ratings by week in each run") + theme_minimal()


colorspalette = rainbow(13, s=0.6, v=0.9)

videostats %>%
  
  ggplot(aes(x = run_number, y = total_views, group = step_position, color = as.factor(step_position))) + geom_line() + geom_point() +
  
  scale_color_manual(values=colorspalette) + geom_label(aes(label = total_views)) + labs(color = "step_position") +
  
  ggtitle("Total views by step position in each run") + theme_minimal()



videostatsaggregate %>%
  
  ggplot(aes(x = step_position, y = viewed_fifty_percent)) + geom_line() + geom_point() +
  
  geom_label(aes(label = viewed_fifty_percent)) +
  
  ggtitle("Average fifty percent view by step position") + theme_minimal()


videostatsaggregate %>%
  
  ggplot(aes(x = step_position, y = viewed_onehundred_percent)) + geom_line() + geom_point() +
  
  geom_label(aes(label = viewed_onehundred_percent)) +
  
  ggtitle("Average hundred percent view by step position") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = viewed_fifty_percent)) + geom_line() + geom_point() +
  
  geom_label(aes(label = viewed_fifty_percent)) +
  
  ggtitle("Average fifty percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = viewed_onehundred_percent)) + geom_line() + geom_point() +
  
  geom_label(aes(label = viewed_onehundred_percent)) +
  
  ggtitle("Average hundred percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = viewed_onehundred_percent)) + geom_line() + geom_point() +
  
  geom_label(aes(label = viewed_onehundred_percent)) +
  
  ggtitle("Average hundred percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = europe_views_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = europe_views_percentage)) +
  
  ggtitle("Europe percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = oceania_views_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = oceania_views_percentage)) +
  
  ggtitle("Oceania percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = asia_views_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = asia_views_percentage)) +
  
  ggtitle("Asia percent view by run") + theme_minimal()  


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = north_america_views_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = north_america_views_percentage)) +
  
  ggtitle("North America percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = south_america_views_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = south_america_views_percentage)) +
  
  ggtitle("South America percent view by run") + theme_minimal()  
  

videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = africa_views_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = africa_views_percentage)) +
  
  ggtitle("Africa percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = desktop_device_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = desktop_device_percentage)) +
  
  ggtitle("Desktop percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = mobile_device_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = mobile_device_percentage)) +
  
  ggtitle("Mobile percent view by run") + theme_minimal()


videostatsaggregaterun %>%
  
  ggplot(aes(x = run_number, y = tablet_device_percentage)) + geom_line() + geom_point() +
  
  geom_label(aes(label = tablet_device_percentage)) +
  
  ggtitle("Tablet percent view by run") + theme_minimal()


```
